<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>è‹±å˜èªã‚¯ã‚¤ã‚º - Ocean</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" th:href="@{/css/ocean-theme.css}">
  <!-- å¿…è¦ã§ã‚ã‚Œã° Bootstrap èª­ã¿è¾¼ã¿ï¼ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«ã¯ä¾å­˜ã—ã¦ã„ãªã„ï¼‰ -->
  <!-- <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" /> -->
  
</head>
<body>
  <div class="quiz-container">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ãªã©ï¼‰ -->
    <div class="header">
      <h1>ğŸŒŠ è‹±å˜èªã‚¯ã‚¤ã‚º</h1>
      <p>æ¬¡ã®è‹±å˜èªã®æ„å‘³ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã‚’1ã¤é¸ã‚“ã§ãã ã•ã„ã€‚</p>
    </div>

    <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ï¼ˆç¾æ™‚ç‚¹ã§ã¯è¦‹ãŸç›®ã®ã¿ï¼‰ -->
    <div class="progress-bar">
      <div class="progress-fill"></div>
    </div>

    <!-- å•é¡Œæ–‡è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="question-section">
      <p class="question-text">
        ã€Œ<span th:text="${questionWord.english}">today</span>ã€ã®æ„å‘³ã¯ï¼Ÿ
      </p>
    </div>

    <!-- â˜… æ­£è§£ã®æ—¥æœ¬èªï¼ˆJS åˆ¤å®šç”¨ï¼‰ -->
    <input type="hidden" id="correctJapanese" th:value="${correctJapanese}" />

    <!-- é¸æŠè‚¢ï¼ˆ2åˆ—ã‚°ãƒªãƒƒãƒ‰ã§é…ç½®ï¼‰ -->
    <div class="answers-grid" id="choices-container">
      <!--
        th:each ã§ 4 ã¤ã®é¸æŠè‚¢ã‚’ç¹°ã‚Šè¿”ã—è¡¨ç¤ºã™ã‚‹ã€‚
        data-choice ã«ã€ãã®é¸æŠè‚¢ã®å€¤ï¼ˆæ—¥æœ¬èªï¼‰ã‚’åŸ‹ã‚è¾¼ã‚“ã§ãŠãã€‚
        JS ã¯å¾“æ¥ã©ãŠã‚Š class="quiz-choice-btn" ã‚’åŸºæº–ã«å‹•ä½œã™ã‚‹ã€‚
      -->
      <button
        type="button"
        class="answer-btn quiz-choice-btn"
        th:each="choice : ${choices}"
        th:text="${choice}"
        th:attr="data-choice=${choice}">
        ã‚µãƒ³ãƒ—ãƒ«é¸æŠè‚¢
      </button>
    </div>

    <!-- ä¸æ­£è§£æ™‚ã®ã¿è¡¨ç¤ºã™ã‚‹ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ -->
    <div class="quiz-next-wrapper">
      <button
        id="nextButton"
        class="quiz-next-button"
        type="button"
        style="display: none;">
        æ¬¡ã¸
      </button>
    </div>
  </div>

  <!-- â˜… ã‚¯ã‚¤ã‚ºç”¨ã® JavaScriptï¼ˆãƒ­ã‚¸ãƒƒã‚¯ã¯å¾“æ¥ã©ãŠã‚Šï¼‰ -->
  <script>
    // ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ãŸã‚‰å‡¦ç†ã‚’é–‹å§‹
    document.addEventListener("DOMContentLoaded", function () {
      // æ­£è§£ã®æ—¥æœ¬èªï¼ˆhidden ã®å€¤ï¼‰
      const correctJapaneseInput = document.getElementById("correctJapanese");
      const correctJapanese = correctJapaneseInput ? correctJapaneseInput.value : "";

      // 4ã¤ã®é¸æŠè‚¢ãƒœã‚¿ãƒ³
      const choiceButtons = document.querySelectorAll(".quiz-choice-btn");

      // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³
      const nextButton = document.getElementById("nextButton");

      // 1å•ã«ã¤ãæœ€åˆã®1ã‚¯ãƒªãƒƒã‚¯ã ã‘ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã®ãƒ•ãƒ©ã‚°
      let answered = false;

      choiceButtons.forEach(function (btn) {
        btn.addEventListener("click", function () {
          // ã™ã§ã«å›ç­”æ¸ˆã¿ãªã‚‰ä½•ã‚‚ã—ãªã„ï¼ˆå¤šé‡ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ï¼‰
          if (answered) {
            return;
          }
          answered = true;

          // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸé¸æŠè‚¢ã®å€¤
          const selected = btn.getAttribute("data-choice");

          // ã™ã¹ã¦ã®é¸æŠè‚¢ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚’ç„¡åŠ¹åŒ–ï¼ˆè¦‹ãŸç›®ã‚‚ã‚¯ãƒªãƒƒã‚¯ä¸å¯ã«ï¼‰
          choiceButtons.forEach(function (b) {
            b.classList.add("disabled");
          });

          if (selected === correctJapanese) {
            // â˜… æ­£è§£ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆï¼š
            //   - ã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒœã‚¿ãƒ³ã‚’æ­£è§£è‰²ã«ã™ã‚‹
            //   - 1.5ç§’å¾Œã«æ¬¡ã®å•é¡Œã¸ï¼ˆ/quiz ã¸é·ç§»ï¼‰
            btn.classList.add("quiz-choice-correct-clicked");

            setTimeout(function () {
              // æ¬¡ã®å•é¡Œã‚’è¡¨ç¤ºï¼ˆGET /quizï¼‰
              window.location.href = "/quiz";
            }, 1500);
          } else {
            // â˜… ä¸æ­£è§£ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆï¼š
            //   - ã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒœã‚¿ãƒ³ã‚’ä¸æ­£è§£è‰²ã«
            //   - æ­£è§£ã®ãƒœã‚¿ãƒ³ã‚’æ­£è§£è‰²ã«
            //   - ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã‚’å¾…ã¤
            btn.classList.add("quiz-choice-wrong-clicked");

            // æ­£è§£ã®é¸æŠè‚¢ã«ã ã‘ã€Œæ­£è§£ã€ã®ã‚¯ãƒ©ã‚¹ã‚’ä»˜ã‘ã‚‹
            choiceButtons.forEach(function (b) {
              const value = b.getAttribute("data-choice");
              if (value === correctJapanese) {
                b.classList.add("quiz-choice-correct-answer");
              }
            });

            // ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œã‚’å¾…ã¤
            if (nextButton) {
              nextButton.style.display = "inline-block";

              nextButton.addEventListener("click", function () {
                // æ¬¡ã®å•é¡Œã‚’è¡¨ç¤ºï¼ˆGET /quizï¼‰
                window.location.href = "/quiz";
              });
            }
          }
        });
      });
    });
  </script>
</body>
</html>
